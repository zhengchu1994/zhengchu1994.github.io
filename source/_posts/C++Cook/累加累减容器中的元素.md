---
title: 累加累减容器中的元素
mathjax: true
date: 2019-09-15 21:53:32
tags: Cooking
categories: C++
visible:
---


#### 累加map中的元素

`accumulate`函数模板：

* Returns the result of accumulating all the values in the range `[first,last)` to init

模板行为：

```c++
template <class InputIterator, class T>
   T accumulate (InputIterator first, InputIterator last, T init)
{
  while (first!=last) {
    init = init + *first;  // or: init=binary_op(init,*first) for the binary_op version
    ++first;
  }
  return init;
}
```

初始值为`init`，用它做累加或累减操作：

```c++
#include <functional>   // minus函数用来做累积减
```

```c++
// accumulate example
#include <iostream>     // std::cout
#include <functional>   // std::minus
#include <algorithm>      // std::accumulate
#include <map>
using namespace std;

struct addValues{
    template<class Value, class Pair>
    Value operator()(Value value, const Pair& pair) const
    {
        return value + pair.second;
    }
};
int main () {
  int init = 100;
  map<int, int> table = {{10, 1}, {20,2}, {30,3}};
  
  int value = accumulate(table.begin(), table.end(), init, addValues());
  cout << "calulate using template: " << value << endl;
  
  value = accumulate(table.begin(), table.end(), init, 
        [](auto value, const map<int, int>::value_type& p){return value + p.second;});
  cout << "caculate by lambda function: " << value << endl;
  
  int arr[] = {1, 3, 5, 7, 8};
  value = accumulate(arr, next(arr, 5), init, minus<int>());
  cout << "get minus numbers in array: " << value << endl;
  
  vector<int> ivec = {1, 3, 5, 7, 8};
  value = accumulate(ivec.begin(), ivec.end(), init, minus<int>());
  cout << "get minus numbers in vector: " << value << endl;
  
  return 0;
}

Output:
calulate using template: 106
caculate by lambda function: 106
get minus numbers in array: 76
get minus numbers in vector: 76
```

